---
title: 多项式同余和本征根
visible: false
---

RSA加密是欧拉定理的精妙应用。解密中的关键步骤是求解$x^E\equiv m\pmod{pq}$。这是我们第一次接触到高于1阶的多项式同模问题。本章我们继续讨论高阶多项式的同余。

## 高阶同余

多项式中的一个最基本的定理是**代数基本定理**（`Fundamental Theorem of Algebra`）。它告诉我们：

**拉格朗日定理**：对于$n$阶的多项式$f(x)=a_nx^n+a_{n-1}x^{n-1}+...+a_1x_1+a_0$最多有$n$个根。

我们在这里不给出证明，但给出对$p$求模的对应版本。

**定义**：我们称$r$是多项式$f(x)=a_nx^n+a_{n-1}x^{n-1}+...+a_1x_1+a_0$的根，当且仅当$f(r)=0$。

**定理6.1**：令多项式$f(x)=a_nx^n+a_{n-1}x^{n-1}+...+a_1x_1+a_0$，其中$n\gt 0, a_n\ne 0, a_i\in\mathbb{Z}$。那么$r$是$f(x)$的根当且仅当存在一个阶数为$n-1$的整数系数多项式$g(x)$，使得$f(x)=(x-r)g(x)$。

要证明这个定理，需要引入**多项式除法算法**：

**多项式除法算法**：令$f(x), g(x)$是首项为1的整数系数多项式，而且$g(x)\ne 0$。那么存在唯一的整数系数多项式$q(x), r(x), deg(r)\lt deg(q)$或者$r(x)=0$使得$f(x)=g(x)q(x)+r(x)$。

这个算法的证明和除法算法证明类似，此处从略。

根据**多项式除法算法**，我们有$f(x)=(x-r)q(x)+r(x)$，而且$deg(r)<1=deg(x-r)$或者$r(x)=0$。这意味着$r(x)$是一个常数$c\in\mathbb{Z}$。

于是，$f(r)=(r-r)q(r)+c=c$。

因此$r$是$f(x)$的根表明$f(r)=0\iff c=0\iff f(x)=(x-r)q(x)$。而$q(x)$的阶数必然是$n-1$。

### 本征根

费马小定理告诉我们$a^{p-1}\equiv 1\pmod{p}$，但对于有些数$a$来说，不需要到幂次$p-1$也能得到相同的结果。让我们继续讨论$ord_p(a)$的细节。

**定理6.4**：假定$p$是一个素数，而$ord_p(a)=d$，那么对于任何自然数$i$，若$(i, d)=1$，那么$ord_p(a^i)=d$。

*证明*：

令$ord_p(a^i)=l$。$(a^i)^d=a^{id}=a^{di}=(a^d)^i\equiv 1\pmod(p)\implies l\mid d$。

又$(i, d)=1\implies ix+dy=1$。于是：$a^l=(a^{ix+dy})^l=a^{ixl}a^{dyl}=((a^i)^l)^x(a^d)^{yl}\equiv 1^x1^{yl}=1\pmod{p}\implies d\mid l$。

所以，$d=l=ord_p(a^j)$。QED。

这个定理告诉我们，所有那些对$p$求模同秩的数字。下一个定理告诉我们，有多少互相不同余的自然数可以对$p$求模同秩。

**定理6.5**：对于素数$p$和一个自然数$d$，最多有$\phi(n)$个对$p$求模互不同余的整数对$p$的秩是$d$。

*证明*：

费马小定理告诉我们，如果$x^n\equiv 1\pmod{p}$有解，那么$n\mid (p-1)$。如果$n\nmid(p-1)$，那么定理显然是成立的。所以我们以下只证明$n\mid(p-1)$的情况。

假定$n\mid(p-1)$，而$ord_p(a)=n$。根据定理6.4，$ord_p(a^j)=n$对于所有$1\le j\le n$，且$(j, n)=1$的情形都成立。这样的$j$正好有$\phi(n)$个，但有些这样的幂可能对$p$求模得到相同的结果，所以最多有$\phi(n)$个这样的数对$p$的秩是$d$。

**定义**：令$p$为一个素数。一个整数$g$，如果$ord_p(g)=p-1$，那么$g$被称为对$p$求模的本征根。

**定理6.6**：令$p$为一个素数，而$g$是对$p$求模的一个本征根。那么集合$\{0, g, g^2, g^3, ..., g^{p-1}\}$构成对$p$的完全余数集。

*证明*：

这个定理很像定理4.8：

>**定理4.8**：令$a, n\in\mathbb{N}, (a, n)=1, k=ord_n(a)$，那么$a^1, a^2, ..., a^k$两两一定与$n$不同模，也就是$a_i\not\equiv a_j\pmod{n}, i\ne j$。

**练习6.7**：对于小于20的素数$p$，找出一个它的本征根，以及本征根的各次幂给出小于$p$的各个自然数。

*练习*：

**首先，强调一下：求本征根是很繁琐的工作。从原则上说，你需要从$[2, n-1]$这里找一个数字，每个数字进行$[2, n-2]$（思考一下为什么是这个区间？）的幂运算才行。这个计算很繁琐。但有一些快捷的方式。以下会进行说明。

$p=2\implies p-1=1$，但2的任何次幂都是偶数，对2求模都是0。但是，$1^1\equiv 1\pmod{2}$，所以也可以说1是对2求模的本征根。这是个特例，不过还是请记住。

$p=3\implies p-1=2$。我们要找到一个数字$g$，使得$ord_3(g)=2\iff g^{3-1}\equiv 1\pmod{3}$。

我们考虑2：$2^2\equiv 1\pmod{3}$，正确。

这么看来，3的一个本征根是2。

5：我们要考虑的是$g^{5-1}\equiv 1\pmod{5}$。很幸运，2就是这么一个数字：$2^4=16\equiv 1\pmod{5}$。所以2是对5求模的本征根！同时我们注意到：

次方|数值|对5求模
:--:|:--:|:--:
1   |2   |2
2   |4   |4
3   |8   |3
4   |16  |1

下一个素数是7，我们可以试验2,3,5,6这四个数字，为什么不试验4？因为4=2*2，如果2不是本征根，那么4肯定也不会是。

我们要测试$g^{7-1}\equiv 1\pmod{7}$。

也还好，我们测试到3就行了：$3^6\equiv 1\pmod{7}$，所以3是对7求模的本征根。细心的朋友会发现，$2^6\equiv 1\pmod{7}$，为什么2不是？因为$2^3\equiv1\pmod{7}$，所以6不是最小的那个数字。

看来我们的测试出了一点问题：我们计算$g^{p-1}\equiv 1\pmod{p}$，但就算如此，也不能保证它是本征根，因为还有一个**最小**的、也就是**秩**的定义的要求。

让我们这样来考虑，一般而言对于一个素数来说，$p-1$是个偶数，是可以被分解的。比如对于11这个素数来说，$p-1=10=2\times5$，如果$g^2$或者$g^5$对11求模为1，那么很显然$g^{10}$也对11求模为1，但是这样的一个$g$不符合本征根的定义。

好，让我们从2开始：

$2^2\equiv 4, 2^5\equiv 10$，都不是1，再测试$2^{10}\equiv 1\pmod{11}$！Bingo！搞定了！

下一个要找的素数是13。$13-1=12=2\times2\times3$。

很幸运：$2^2\equiv 4, 2^3\equiv 8, 2^6\equiv 12， 2^12\equiv 1\pmod{13}$。所以，对13求模的本征根是2。

下一个是17。$17-1=16=2\times2\times2\times2$，它的因子有$2, 4, 8$。

$2^2\equiv 4, 2^4\equiv 16, 2^8\equiv 1$，不好！到了8次方就出现1了，所以2不是本征根。

$3^2\equiv 9, 3^3\equiv 13, 3^8\equiv 16$，妙极了！3是对17求模的本征根！

最后来看看19！$19-1=18=2\times3\times3$。它的因子是$2, 3, 6, 9$。

$2^2\equiv 4, 2^3\equiv 8, 2^6\equiv 7, 2^9\equiv 18\pmod{19}$，很好！2就是对19求模的本征根！

好了。求本征根的过程已经很明确了，总结如下：

1. 对$p-1$进行素数分解，找出所有的因子（**注意，不只是质因子！**）${f_1, f_2, ..., f_k}$，但不包括$p-1$（因为根据费马小定理，$a^{p-1}\equiv 1\pmod{p}$，但不一定$p-1$就是本征根）。
2. 从2开始，对所有的$f$计算$2^{f_i}$对$p$的模，如果为1，就可以停止运算。因为这个数字（2）肯定不是本征根，进入第4步。
3. 如果第二步计算中得到的模都不为1，那么这个数字就是本征根。
4. 换一个数字开始计算，一般就是加1。

虽然有了改善，但是我们看到，这个计算仍然非常繁琐。我的建议是，对于那些非常大的数字，用[Wolfram](https://www.wolframalpha.com/)来帮助计算会好一些。下面是一个截图：

![Finding primitive root with Wolfram](./wolfram_finding_primitive_root.png)

从上面的练习我们也许可以猜想：**每个素数都有至少一个本征根**。确实如此。

**定理6.8**：每个素数$p$都有一个本征根。

这个定理现在我们还很难证明，还需要引入一些有关欧拉$\phi$函数的引理才行。

我们已经证明，对于$p-1$的任何因子$d$，最多有$\phi(d)$个互不同余的数字对$p$求模的秩是$d$。我们也知道对于每个自然数$k\lt p$，它有一个秩$d$，且$d\mid p-1$（定理4.16）。

我们用13这个数字来做个练习。

**练习6.9**：考虑素数$13$。对于$13-1=12$的因子$d\in\{1, 2, 3, 4, 6, 12\}$，在集合$\{1, 2, 3, ..., 12\}$中标出哪些数字具有的秩为$d$。

*解*：

让我们一个一个开始，以下列式中省去$\pmod{13}$的书写。

$1^1\equiv 1\implies ord_{13}1=1$

$2^{12}\equiv 1\implies ord_{13}2=12$

$3^{3}\equiv 1\implies ord_{13}3=3$

$4^{6}\equiv 1\implies ord_{13}4=6$

$5^{4}\equiv 1\implies ord_{13}5=4$

$6^{12}\equiv 1\implies ord_{13}6=12$

$7^{12}\equiv 1\implies ord_{13}7=12$

$8^{4}\equiv 1\implies ord_{13}8=4$

$9^{3}\equiv 1\implies ord_{13}9=3$

$10^{6}\equiv 1\implies ord_{13}10=6$

$11^{12}\equiv 1\implies ord_{13}11=12$

$12^{2}\equiv 1\implies ord_{13}12=2$

我们可以注意到一个事实：**对于每个$d$，都恰好有$\phi(d)$个数字的秩是$d$**，而且：

$\phi(1)+\phi(2)+\phi(3)+\phi(4)+\phi(6)+\phi(12)=12$，或者简写为：$\sum_{d\mid n}\phi(d)$。

**引理6.11**：如果$p$是一个素数，那么$\sum_{d\mid p}\phi(d)=p$。

*证明*：

显然，作为素数$p$，它的因子只能是1和$p$。而$\phi(1)=1, \phi(p)=p-1$。QED。

对于素数的幂次$p^k$来说，在$[1, p^k]$（或者$[0, p^k-1]$）的范围内，一共有$p^k$个数字，根据$phi$函数的定义，和$p^k$**不**互质的数字有：$0, p, 2p, 3p, ...$，也就是每$p$个数有一个，所以$\phi(p^k)=p^k-p^{k-1}$。

于是我们可以证明一个很重要的引理：

**引理6.12**：如果$p$是一个素数，那么$\sum_{d\mid p^k}\phi(d)=p^k$。

*证明*：

对于$p^k$而言，它的因子有：$1, p, p^2, p^3, ..., p^{k}$，我们有：

$\phi(1)=1\\\phi(p)=p^1-1\\\phi(p^2)=p^2-p^1\\...\\\phi(p^k)=p^k-p^{k-1}$

将这些式子累加得到$\sum_{d\mid p^k}\phi(d)=p^k$。QED。

