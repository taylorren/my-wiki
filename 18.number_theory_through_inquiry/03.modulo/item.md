---
title: 模的世界
visible: false
---

本章我们进入模的世界！

我们先复习一下第一章中的几个定理：

**定理1.12**：令$a, b, c, d, n$为整数，且$n\gt0$。若$a\equiv b\:(mod\:n), c\equiv d\:(mod\:n)$，则$a+c\equiv b+d\:(mod\:n)$。

**定理1.13**：令$a, b, c, d, n$为整数，且$n\gt0$。若$a\equiv b\:(mod\:n), c\equiv d\:(mod\:n)$，则$a-c\equiv b-d\:(mod\:n)$。

**定理1.14**：令$a, b, c, d, n$为整数，且$n\gt0$。若$a\equiv b\:(mod\:n), c\equiv d\:(mod\:n)$，则$ac\equiv bd\:(mod\:n)$。

**定理1.18**：令$a, b, k, n$为整数，且$n\gt0, k\gt0$。若$a\equiv b\:(mod\:n)$，则$a^k\equiv b^k\:(mod\:n)$

也就是说，模的运算对加法、减法、乘法以及指数运算都是成立的。

**练习3.1**：证明41可以整除$2^{20}-1$。

*证明*：

1. $2^5\equiv -9\:\:(mod\:41)$（算术运算）
2. $(2^5)^4\equiv (-9)^4\:\:(mod\:41)$（模的指数运算）
3. $2^{20}\equiv81^2\:\:(mod\:41）\equiv(-1)^2\:\:(mod\:41)\equiv1\:\:(mod\:41)$
4. $2^{20}-1\equiv0\:\:(mod\:41)$

**练习3.2**：找到一个数字$k, 0\le k\le11$，s.t $k\equiv 37^{453}\:\:(mod\:12)$

*解*：

1. $37\equiv 1\:\:(mod\:12)$
2. $37^{453}\equiv 1\:\:(mod\:12)$

所以，$k=1$。

**练习3.3**：找到一个数字$k, 0\le k\le 6$，s.t. $2^{50}\equiv k\:\:(mod\:7)$

*解*：

$2^3\equiv 1\:\:(mod\:7)$。$2^{50}=2^{3*16+2}\equiv{2^3}^{16}*4\:\:(mod\:7)\equiv 4\:\:(mod\:7)$，所以$k=4$。

**练习3.4**：找到一个数字$k, 0\le k\le 11$，s.t. $39^{453}\equiv k\:\:(mod\:12)$

*解*：

因为$39\equiv 3\:\:mod(\:12)$，所以$39^{453}\equiv 3^{453}\:\:mod(\:12)$。

**解法一**：简单观察可以知道，$3^1\equiv 3\:\:(mod\:12), 3^2\equiv 9\:\:(mod\:12), 3^3\equiv 27\equiv 3\:\:(mod\:12), 3^4\equiv 81\equiv 9\:\:(mod\:12)$。所以，通过数学归纳法可以证明，`3`的奇数次方与`3`同模于12，`3`的偶数次方与`9`同模于12。而`453`是个奇数，所以$39^{453}\equiv 3^{453}\equiv 3\:\:mod(\:12)$。所以$k=3$。

**解法二**：

$3^{453}=3^{3*151}=(3^3)^{151}\equiv 3^{151}\:\:mod(\:12)$。

$3^{151}=3^{3*50+1}=(3^3)^{50}*3\equiv 3^{50}*3=3^{51}\:\:mod(\:12)$。

$3^{51}=3^{3*17}=(3^3)^{17}\equiv 3^{17}\:\:mod(\:12)$。

$3^{17}=3^{3*5+2}=(3^3)^5*3^2\equiv 3^5*3^2=3^7\:\:mod(\:12)$。

$3^7=3^{3*2+1}=(3^3)^2*3\equiv 3^2*3=3^3\equiv 3\:\:mod(\:12)$。

所以$k=3$。

**练习3.5**：证明$39\mid (17^{48}-5^{24})$

*证明*：

我们先看$17^{48}$。以下计算中省去对39求模的书写：

1. $17^2=289=16$
2. $16^2=256=22$
3. $22^3=10648=1$

换句话说，也就是$17^{48}=((17^2)^2)^3=(17^4)^3\equiv 22^3=10648\equiv 1\:\:(mod\:39)$。

同时，注意到$5^4=625=1$，所以$5^{24}=(5^4)^6\equiv 1\:\:(mod\:39)$。

所以$17^{48}\equiv 5^{24}\equiv 1\:\:(mod\:39)\implies 17^{48}-5^{24}\equiv 0\:\:(mod\:39)\implies 39\mid 17^{48}-5^{24}$。QED。

**思考题3.6**：令$a, n, r$为自然数，存在一个过程来找到$k, 0\le k \le n-1$，s.t $k\equiv a^r\:\:(mod\:n)$，而且在此过程中你不用乘以大于$n$的数字，而且这样的乘法步数不超过$log_2 r$。

这个步骤对于计算机而言而重要，在后续的[公钥加密](../public)中还会深入讨论。

**练习3.7**：证明$f(98)\equiv f(-100)\:\:(mod\:99)$，其中$f(x)=13x^{49}-27x^{27}+x^{14}-6$。

*证明*：

由$98\equiv -100\:\:(mod\:99)$，以及模运算的定理，我们知道这个由加减乘和指数运算构成的多项式也一定同模于99。QED。

**定理3.8**：令$f(x)=a_nx^n+a_{n-1}x^{n-1}+...+a_0$是一个多项式。令$a, b, m$为整数且$m\gt 0$。如果$a\equiv b\:\:(mod\:m)$，那么$f(a)\equiv f(b)\:\:(mod\:m)$。

*证明*：（略）

**定理3.11**：令$f(x)=a_nx^n+a_{n-1}x^{n-1}+...+a_0$是一个多项式，其中$n\gt 0, a_n\gt 0$，那么存在一个整数$k$，s.t 如果$x\gt k$，那么$f(x)\gt 0$。

*证明*：

$lim_{x\to \infty}\frac{f(x)}{x^n}=lim_{x\to \infty}a_n+a_{n-1}x^{-1}+...+a_1x^{1-n}+a_0x^{-n}=a_n\gt 0$。只要$x$是正整数，$x^n$就会越来越大，这意味着$lim_{x\to \infty}f(x)=\infty$，所以我们可以找到某个数字$k$, s.t. 对于所有$x\gt k$，$f(x)\gt 0$。QED。

**定理3.12**：令$f(x)=a_nx^n+a_{n-1}x^{n-1}+...+a_0$是一个多项式，其中$n\gt 0, a_n\gt 0$，那么对于任何一个数字$M$，存在一个整数$k$，s.t 如果$x\gt k$，那么$f(x)\gt M$。[^1]

*证明*：（略）

上面两个定理与模运算无关。它们表明，一个首项系数为正整数的多项式函数值，从某一点开始不仅永远为正，而且会越来越大。

下面这个定理将多项式和素数加以关联。它表明，每个多项式都可以产生无数多个合数，也就是不存在一个多项式只产生素数。

**定理3.13**：令$f(x)=a_nx^n+a_{n-1}x^{n-1}+...+a_0$是一个多项式。那么存在无数多的整数$x$，s.t $f(x)$是一个合数。提示：使用定理3.8和3.12。

*证明*：

第一步，我们要证明对于任意$n$次多项式，它最多取一个相同值的次数不超过$n$次。

我们首先证明：对于任意$n$次多项式方程（也就是$f(x)=a_nx^n+a_{n-1}x^{n-1}+...+a_0=0$，它最多有$n$个不同的根。

对于$n=1$，定理成立。假定$n-1$时，定理也成立。

假定$a$是方程的一个根，$f(x)$可以写成$f(x)=(x-a)g(x)=0$，其中的$g(x)$为$n-1$次。

$f(b)=0 \Leftrightarrow b=a$或者$g(x)=0$。所以$g(x)$最多提供$n-1$个$f(x)=0$的根，$a$是最多第$n$个根。所以$f(x)=0$最多有$n$个根。QED。

顺便说一句，这个定理在某种程度上可以被视为“**代数基本定理**”（Fundamental Theorem of Algebra）。

证明这个后，我们可以马上证明，任意$n$次多项式，也就是$f(x)=a_nx^n+a_{n-1}x^{n-1}+...+a_0$得到某个特定值最多有$n$次。

下面进入定理3.13的证明。假定不存在任何整数，使得$f(x)$为合数，那么$f(x)$只能取值0,1或者一个素数。由代数基本定理，$f(x)=0$或者$1$的次数是有限的，所以$f(x)$可以得到无数多个素数。

假定$f(x)=p$，且$p$是一个素数。我们观察：

$f(x+kp)-f(x)=a_n((x+kp)^n-x^n)+a_{n-1}((x+kp)^{n-1}-x^{n-1})+...+a_1((x+kp)-x)+(a_0-a_0)=kpa_n((x+kp)^{n-1}+...+x^{n-1})+kpa_{n-1}((x+kp)^{n-2}+...+x^{n-2}+...+kpa_1$。因此$f(x+kp)-f(x)$一定是$p$的倍数，而$f(x)=p$，所以$f(x+kp)$也是p的倍数。但是，我们规定$f(x)$只能产生素数，所以$f(x+kp)=p$。换句话说，我们有无数个$k$使得$f(x+kp)=p$。这个和基本定理是矛盾的。

所以，$f(x)$不能只产生素数，只能产生无数多个合数。QED。

**注意**：上述证明中没有用到定理3.8和3.12。

另外一种证法用到3.8和3.12（至少是3.8）。

我们选择一个$m$，使得$f(m)\ne \pm 1$——这可以通过前一个证明中得到。选择一个素数$p$，使得$p\mid f(m)$。因此，对于$m+pk$，我们有$(m+pk)\equiv m\:\:(mod\:p)=0$。根据定理3.8，有$f(m+pk)\equiv f(m)\:\:(mod\:p)=0$。所以$f(m+pk)$是一个合数。QED。[^2]

多么令人悲伤的结论啊！这个定理向我们表明，我们**没法**找到一个具有“魔力”的多项式，使其只为我们产生素数。不过有一些多项式表现很不错，比如$f(x)=x^2+x+41$可以为我们连续产生80个素数（$n\in [-40, 39]$）。但在$n=40$时，$f(40)=1681=41^2$。

[^1]: 这里我们假定所有多项式的系数都是整数。下同。

[^2]: 定理3.8要求多项式首项系数$a_n\gt 0$。但定理3.13的叙述中并没有强调这点。我还要再思索一下。
